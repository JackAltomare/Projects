# Convert the 'Transaction Date' column to datetime format
data['Transaction Date'] = pd.to_datetime(data['Transaction Date'], format='%d/%m/%Y %I:%M %p')

# Add a financial year column
data['Financial Year'] = data['Transaction Date'].apply(lambda x: f"{x.year-1}/{x.year}" if x.month < 7 else f"{x.year}/{x.year+1}")

# Separate buy and sell transactions
buy_data = data[data['Type'] == 'Buy']
sell_data = data[data['Type'] == 'Sell']

# Calculate profit/loss for each financial year
profit_loss_by_year = sell_data.groupby('Financial Year')['Total AUD'].sum() - buy_data.groupby('Financial Year')['Total AUD'].sum()

# Replace NaN with 0 (in case there are no sell transactions in a given year)
profit_loss_by_year = profit_loss_by_year.fillna(0)

# Display the profit/loss by financial year
profit_loss_by_year
